{% extends "base.html" %}

{% block content %}
<div class="form-container">

  <form method="POST" enctype="multipart/form-data">
    <label>Enter your name:</label>
    <input type="text" name="name" required pattern="[A-Za-z ]+">

    <label>Study duration (minutes or mm:ss):</label>
    <input type="text" name="duration" placeholder="e.g. 1, 1:00, 1:30, 02:30" required>

    <label>Custom Sound (optional):</label>
    <input type="file" name="sound" accept=".mp3,.wav">

    <button type="submit" class="start-btn">
      <img src="{{ url_for('static', filename='images/play.png') }}" alt="Start" class="btn-icon">Start</button>

  </form>
</div>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const nameInput = document.querySelector("input[name='name']");
  const durationInput = document.querySelector("input[name='duration']");
  const submitBtn = document.querySelector("button[type='submit']");

  function validateName() {
    const text = nameInput.value.trim();
    if (/^[A-Za-z ]+$/.test(text)) {
      nameInput.style.borderColor = "green";
      return true;
    } else if (text === "") {
      nameInput.style.borderColor = "gray";
      return false;
    } else {
      nameInput.style.borderColor = "red";
      return false;
    }
  }

  function validateDuration() {
    const text = durationInput.value.trim();
    if (/^\d+$/.test(text) && parseInt(text) > 0) {
      durationInput.style.borderColor = "green";
      return true;
    }
    if (/^\d+:\d{2}$/.test(text)) { // mm:ss format
      durationInput.style.borderColor = "green";
      return true;
    }
    durationInput.style.borderColor = "red";
    return false;
  }

  function updateButtonState() {
    submitBtn.disabled = !(validateName() && validateDuration());
  }

  nameInput.addEventListener("input", () => {
    // auto-capitalize each word
    nameInput.value = nameInput.value.replace(/\b\w/g, c => c.toUpperCase());
    updateButtonState();
  });

  durationInput.addEventListener("input", updateButtonState);
});
</script>

{% endblock %}
